"use strict";(self.webpackChunkproyecto=self.webpackChunkproyecto||[]).push([[174],{5174:(he,T,s)=>{s.r(T),s.d(T,{WarehousesModule:()=>ce});var Z=s(9808),_=s(1083),d=s(4999),N=s(4847),h=s(8966),y=s(5226),f=s.n(y),e=s(5e3),l=s(3075);let w=(()=>{class o{constructor(t){this.fb=t,this.baseForm=this.fb.group({idWarehouse:[""],name:["",l.kI.required],floor:["",l.kI.required],zone:["",l.kI.required]})}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(l.qu))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var C=s(2340),g=s(520),b=s(262),x=s(2843);let A=(()=>{class o{constructor(t){this.http=t,this.token="Bearer eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiJEZXZlbG9wZXIiLCJhdXRob3JpdGllcyI6W3siYXV0aG9yaXR5IjoiYWNjb3VudDpyZWFkIn0seyJhdXRob3JpdHkiOiJhY2NvdW50OndyaXRlIn0seyJhdXRob3JpdHkiOiJ1c2VyOnJlYWQifSx7ImF1dGhvcml0eSI6InVzZXI6d3JpdGUifSx7ImF1dGhvcml0eSI6IlJPTEVfQURNSU4ifV0sImFjY291bnQiOiIwMzM5MTdhNy1mMTc4LTQ4NjgtYjkxZi1jYjJmNDc0OTViNjYiLCJpYXQiOjE2NTQ1MDU5MTgsImV4cCI6MTY1NTMzMDQwMH0.wrt9P7XLI0JHjPKaM3UAGeGPFs6dYozsCrBHodLnOolOyaL2HsOBbHnr5LMF7r2GfpzFSiz1LX-AKVmRtGB-uA"}getWarehouses(t){const n=new g.WM({Authorization:this.token});return this.http.get(`${C.N.api_url}/api/v1/buildings/${t}/warehouses`,{headers:n}).pipe((0,b.K)(this.handlerError))}newWarehouse(t,n){const i=new g.WM({Authorization:this.token});return this.http.post(`${C.N.api_url}/api/v1/buildings/${t}/warehouses`,n,{headers:i}).pipe((0,b.K)(this.handlerError))}updateWarehouse(t,n,i){const r=new g.WM({Authorization:this.token});return this.http.put(`${C.N.api_url}/api/v1/buildings/${t}/warehouses/${n}`,i,{headers:r}).pipe((0,b.K)(this.handlerError))}deleteWarehouse(t,n){const i=new g.WM({Authorization:this.token});return this.http.delete(`${C.N.api_url}/api/v1/buildings/${t}/warehouses/${n}`,{headers:i}).pipe((0,b.K)(this.handlerError))}handlerError(t){let n="Errr unknown";return t&&(n=`Error ${t.message}`),window.alert(n),(0,x._)(n)}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(g.eN))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var W=s(7322),B=s(7531),M=s(7423),p=(()=>{return(o=p||(p={})).EDIT="edit",o.NEW="new",p;var o})();let I=(()=>{class o{constructor(t,n,i){this.data=t,this.warehouseForm=n,this.warehouseSvc=i,this.actionToDO=p.NEW}ngOnInit(){var t,n;(null===(n=null===(t=this.data)||void 0===t?void 0:t.warehouses)||void 0===n?void 0:n.hasOwnProperty("idWarehouse"))&&(this.actionToDO=p.EDIT,this.pathFormData(),this.data.title="Modificar almac\xe9n")}onSave(){var t,n;const i=this.warehouseForm.baseForm.value,r=this.data.idBuilding,c=null===(n=null===(t=this.data)||void 0===t?void 0:t.warehouses)||void 0===n?void 0:n.idWarehouse;let u;this.actionToDO===p.NEW?(u=this.warehouseSvc.newWarehouse(r,i),u.subscribe(m=>{f().fire({title:"Creado",text:"La cuenta ha sido creado correctamente",icon:"success",timer:800}),f().showLoading()})):(u=this.warehouseSvc.updateWarehouse(r,c,i),u.subscribe(m=>{f().fire({title:"Modificado",text:"La cuenta ha sido modificado correctamente",icon:"success",timer:800}),f().showLoading()}))}pathFormData(){var t,n,i,r,c,u,m,v;this.warehouseForm.baseForm.setValue({idWarehouse:null===(n=null===(t=this.data)||void 0===t?void 0:t.warehouses)||void 0===n?void 0:n.idWarehouse,name:null===(r=null===(i=this.data)||void 0===i?void 0:i.warehouses)||void 0===r?void 0:r.name,floor:null===(u=null===(c=this.data)||void 0===c?void 0:c.warehouses)||void 0===u?void 0:u.floor,zone:null===(v=null===(m=this.data)||void 0===m?void 0:m.warehouses)||void 0===v?void 0:v.zone})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(h.WI),e.Y36(w),e.Y36(A))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-modal-warehouses"]],decls:22,vars:4,consts:[["mat-dialog-title",""],[1,"animated","fadeIn","faster"],[1,"modal-form"],[3,"formGroup"],[1,"full-width-input"],["matInput","","placeholder","Nombre del almac\xe9n","required","","name","nombre","formControlName","name"],["matInput","","placeholder","Nombre de la zona","required","","name","zona","formControlName","zone"],["matInput","","placeholder","Planta","type","number","required","","name","piso","formControlName","floor"],["align","end"],["mat-button","","mat-dialog-close",""],["type","button","ckdFocusInitial","",1,"btn","btn-primary",3,"mat-dialog-close","disabled","click"]],template:function(t,n){1&t&&(e.TgZ(0,"h2",0),e._uU(1),e.qZA(),e.TgZ(2,"mat-dialog-content",1)(3,"div",2)(4,"form",3)(5,"mat-form-field",4)(6,"mat-label"),e._uU(7,"Nombre del almac\xe9n"),e.qZA(),e._UZ(8,"input",5),e.qZA(),e.TgZ(9,"mat-form-field",4)(10,"mat-label"),e._uU(11,"Nombre de zona"),e.qZA(),e._UZ(12,"input",6),e.qZA(),e.TgZ(13,"mat-form-field",4)(14,"mat-label"),e._uU(15,"Planta"),e.qZA(),e._UZ(16,"input",7),e.qZA()()()(),e.TgZ(17,"mat-dialog-actions",8)(18,"button",9),e._uU(19,"Cancelar"),e.qZA(),e.TgZ(20,"button",10),e.NdJ("click",function(){return n.onSave()}),e._uU(21," Guardar "),e.qZA()()),2&t&&(e.xp6(1),e.hij(" ",null==n.data?null:n.data.title,"\n"),e.xp6(3),e.Q6J("formGroup",n.warehouseForm.baseForm),e.xp6(16),e.Q6J("mat-dialog-close",!0)("disabled",n.warehouseForm.baseForm.invalid))},directives:[h.uh,h.xY,l._Y,l.JL,l.sg,W.KE,W.hX,B.Nt,l.Fj,l.Q7,l.JJ,l.u,l.wV,h.H8,M.lW,h.ZT],styles:[".modal-form[_ngcontent-%COMP%]{padding:1rem 0}.modal-form[_ngcontent-%COMP%]   .full-width-input[_ngcontent-%COMP%]{width:100%}.false[_ngcontent-%COMP%]{margin-left:10px}"]}),o})();var F=s(7579),O=s(2722),J=s(7850),S=s(9761),U=s(6303);let Y=(()=>{class o{constructor(t){this.fb=t,this.baseForm=this.fb.group({account:this.fb.group({idAccount:["",l.kI.required]}),building:this.fb.group({idBuilding:["",l.kI.required]})})}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(l.qu))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var E=s(9882),Q=s(4107),q=s(508);function D(o,a){if(1&o&&(e.TgZ(0,"mat-option",15),e._uU(1),e.qZA()),2&o){const t=a.$implicit;e.Q6J("value",t),e.xp6(1),e.hij("",t.name," ")}}function k(o,a){if(1&o&&(e.TgZ(0,"mat-option",15),e._uU(1),e.qZA()),2&o){const t=a.$implicit;e.Q6J("value",t.idBuilding),e.xp6(1),e.Oqu(t.name)}}function H(o,a){if(1&o){const t=e.EpF();e.TgZ(0,"div",0)(1,"button",16),e.NdJ("click",function(){return e.CHM(t),e.oxw().onOpenModal()}),e._uU(2," Agregar almac\xe9n \xa0 "),e._UZ(3,"i",17),e.qZA()()}}function z(o,a){1&o&&(e.TgZ(0,"div",18)(1,"h4",19),e._uU(2,"No hay almacenes"),e.qZA(),e.TgZ(3,"p"),e._UZ(4,"i",20),e.qZA()())}function P(o,a){1&o&&(e.TgZ(0,"div",0)(1,"button",21)(2,"a",22),e._uU(3,"Ir a hospitales"),e.qZA()()())}function G(o,a){1&o&&(e.TgZ(0,"div",18)(1,"h4",19),e._uU(2,"No hay edificios"),e.qZA(),e.TgZ(3,"p"),e._UZ(4,"i",20),e.qZA()())}function $(o,a){1&o&&(e.TgZ(0,"th",36),e._uU(1,"#"),e.qZA())}function R(o,a){if(1&o&&(e.TgZ(0,"td",37),e._uU(1),e.qZA()),2&o){const t=a.index;e.xp6(1),e.Oqu(t+1)}}function L(o,a){1&o&&(e.TgZ(0,"th",36),e._uU(1,"Nombre"),e.qZA())}function j(o,a){if(1&o&&(e.TgZ(0,"td",37),e._uU(1),e.qZA()),2&o){const t=a.$implicit;e.xp6(1),e.Oqu(t.name)}}function X(o,a){1&o&&(e.TgZ(0,"th",36),e._uU(1,"Zona"),e.qZA())}function V(o,a){if(1&o&&(e.TgZ(0,"td",37),e._uU(1),e.qZA()),2&o){const t=a.$implicit;e.xp6(1),e.Oqu(t.zone)}}function K(o,a){1&o&&(e.TgZ(0,"th",36),e._uU(1,"Planta"),e.qZA())}function ee(o,a){if(1&o&&(e.TgZ(0,"td",37),e._uU(1),e.qZA()),2&o){const t=a.$implicit;e.xp6(1),e.Oqu(t.floor)}}function te(o,a){1&o&&(e.TgZ(0,"th",38),e._uU(1,"Editar"),e.qZA())}function oe(o,a){if(1&o){const t=e.EpF();e.TgZ(0,"td",37)(1,"div",39)(2,"button",40),e.NdJ("click",function(){const r=e.CHM(t).$implicit;return e.oxw(2).onOpenModal(r)}),e._uU(3," Editar \xa0 "),e._UZ(4,"i",41),e.qZA()()()}}function ne(o,a){1&o&&(e.TgZ(0,"th",38),e._uU(1,"Eliminar"),e.qZA())}function ae(o,a){if(1&o){const t=e.EpF();e.TgZ(0,"td",37)(1,"div",39)(2,"button",42),e.NdJ("click",function(){const r=e.CHM(t).$implicit;return e.oxw(2).onDelete(r.building.idBuilding,r.idWarehouse)}),e._uU(3," Eliminar \xa0 "),e._UZ(4,"i",43),e.qZA()()()}}function ie(o,a){1&o&&e._UZ(0,"tr",44)}function se(o,a){1&o&&e._UZ(0,"tr",45)}function re(o,a){if(1&o){const t=e.EpF();e.TgZ(0,"div",23)(1,"button",16),e.NdJ("click",function(){return e.CHM(t),e.oxw().onOpenModal()}),e._uU(2," Agregar almac\xe9n \xa0 "),e._UZ(3,"i",17),e.qZA(),e.TgZ(4,"table",24),e.ynx(5,25),e.YNc(6,$,2,0,"th",26),e.YNc(7,R,2,1,"td",27),e.BQk(),e.ynx(8,28),e.YNc(9,L,2,0,"th",26),e.YNc(10,j,2,1,"td",27),e.BQk(),e.ynx(11,29),e.YNc(12,X,2,0,"th",26),e.YNc(13,V,2,1,"td",27),e.BQk(),e.ynx(14,30),e.YNc(15,K,2,0,"th",26),e.YNc(16,ee,2,1,"td",27),e.BQk(),e.ynx(17,31),e.YNc(18,te,2,0,"th",32),e.YNc(19,oe,5,0,"td",27),e.BQk(),e.ynx(20,33),e.YNc(21,ne,2,0,"th",32),e.YNc(22,ae,5,0,"td",27),e.BQk(),e.YNc(23,ie,1,0,"tr",34),e.YNc(24,se,1,0,"tr",35),e.qZA()()}if(2&o){const t=e.oxw();e.xp6(4),e.Q6J("dataSource",t.dataSource),e.xp6(19),e.Q6J("matHeaderRowDef",t.displayedColumns),e.xp6(1),e.Q6J("matRowDefColumns",t.displayedColumns)}}const le=[{path:"",component:(()=>{class o{constructor(t,n,i,r,c,u,m,v){this.accountSvc=t,this.hospitalSvc=n,this.warehouseSvc=i,this.dialog=r,this.warehouseForm=c,this.warehosForm=u,this.buildingSvc=m,this.router=v,this.buildings=[],this.hospitals=[],this.Buildings=[],this.destroy$=new F.x,this.cargadoWarehouse=!0,this.cargadoHospital=!0,this.cargadoBuilding=!0,this.warehouses=[],this.displayedColumns=["#","name","zone","floor","edit","delete"],this.dataSource=new d.by}ngAfterViewInit(){this.dataSource.sort=this.empTbSort}ngOnDestroy(){this.destroy$.next({}),this.destroy$.complete()}onSave(){this.cargadoWarehouse=!0,this.warehouseSvc.getWarehouses(this.idBuilding).subscribe(t=>{this.dataSource.data=t,this.cargadoWarehouse=!1})}ngOnInit(){null==localStorage.getItem("token")&&this.router.navigate([""]),this.cargadoHospital=!0,this.hospitalSvc.getHospital().subscribe(t=>{this.hospitals=t,this.cargadoHospital=!1})}getBuildings(){this.buildingSvc.getBuilding(this.idAccount,this.idHospital).subscribe(t=>{this.buildings=t,this.cargadoBuilding=!1}),this.buildingSvc.getBuilding(this.idAccount,this.idHospital).subscribe(t=>{this.Buildings=t})}getIdAccount(t){this.idAccount=t.account.idAccount,this.idHospital=t.idHospital,console.log("a ",this.idAccount+" b ",this.idHospital)}getIdEdificio(t){this.idBuilding=t}onOpenModal(t={}){this.dialog.open(I,{height:"50%",width:"40%",hasBackdrop:!1,data:{title:"Nuevo almacen",warehouses:t,idBuilding:this.idBuilding}}).afterClosed().subscribe(i=>{this.warehouseSvc.getWarehouses(this.idBuilding).subscribe(r=>{this.dataSource.data=r,this.warehouseForm.baseForm.reset()})})}onOpenModalBuilding(){}onDelete(t,n){const i=f().mixin({customClass:{confirmButton:"btn btn-success",cancelButton:"btn btn-danger"},buttonsStyling:!1});i.fire({title:"\xbfSeguro que quieres borrar esta cuenta?",icon:"warning",showCancelButton:!0,confirmButtonText:"Eliminar",cancelButtonText:"Cancelar",reverseButtons:!0}).then(r=>{r.isConfirmed?(i.fire("Eliminado","La cuenta ha sido eliminado correctamente","success"),this.warehouseSvc.deleteWarehouse(t,n).pipe((0,O.R)(this.destroy$)).subscribe(c=>{this.warehouseSvc.getWarehouses(t).subscribe(u=>{this.dataSource.data=u})})):r.dismiss===f().DismissReason.cancel&&i.fire("Cancelado","La cuenta no ha sido eliminada","error")})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(S.B),e.Y36(U.a),e.Y36(A),e.Y36(h.uw),e.Y36(w),e.Y36(Y),e.Y36(E.F),e.Y36(_.F0))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-warehouses"]],viewQuery:function(t,n){if(1&t&&(e.Gf(N.YE,5),e.Gf(J.NW,5)),2&t){let i;e.iGM(i=e.CRH())&&(n.empTbSort=i.first),e.iGM(i=e.CRH())&&(n.paginator=i.first)}},decls:28,vars:9,consts:[[1,"animated","fadeIn","faster"],[1,"mt-5","w-90"],[1,"modal-form","mt-2"],[3,"formGroup"],["formGroupName","account",1,"full-width-input"],["name","cuenta","placeholder","Selecciona un hospital","required","","formControlName","idAccount",3,"selectionChange"],["idAccount",""],[3,"value",4,"ngFor","ngForOf"],["formGroupName","building",1,"full-width-input"],["required","","name","hospital","placeholder","Selecciona un edificio","formControlName","idBuilding",3,"click","selectionChange"],["idEdificio",""],["type","button","ckdFocusInitial","",1,"btn","btn-primary",3,"disabled","click"],["class","animated fadeIn faster",4,"ngIf"],["class","alert alert-warning text-center mt-3 w-50 animated fadeIn faster mt-5",4,"ngIf"],["class","animated fadeIn faster","id","divshow",4,"ngIf"],[3,"value"],["type","button",1,"btn","btn-primary","mt-3",3,"click"],[1,"fa-solid","fa-plus"],[1,"alert","alert-warning","text-center","mt-3","w-50","animated","fadeIn","faster","mt-5"],[1,"alert-heading"],[1,"fa","fa-exclamation","fa-2x"],["type","button",1,"btn","btn-primary","mt-3"],["routerLink","/admin/hospitals"],["id","divshow",1,"animated","fadeIn","faster"],["mat-table","",1,"mt-5",3,"dataSource"],["matColumnDef","#",1,"width"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","name"],["matColumnDef","zone"],["matColumnDef","floor"],["matColumnDef","edit"],["mat-header-cell","","class","action",4,"matHeaderCellDef"],["matColumnDef","delete"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["mat-cell",""],["mat-header-cell","",1,"action"],[1,"table-button-row"],["mat-flat-button","",1,"edit",3,"click"],[1,"fa-solid","fa-pen-to-square"],["mat-flat-button","","color","warn",1,"del",3,"click"],[1,"fa-solid","fa-trash"],["mat-header-row",""],["mat-row",""]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"h1",1),e._uU(2,"Almacenes"),e.qZA(),e._UZ(3,"hr"),e.TgZ(4,"mat-dialog-content")(5,"div",2)(6,"h2"),e._uU(7,"\xbfQu\xe9 almac\xe9n quieres ver?"),e.qZA(),e.TgZ(8,"form",3)(9,"mat-form-field",4)(10,"mat-label"),e._uU(11,"Selecciona una cuenta"),e.qZA(),e.TgZ(12,"mat-select",5,6),e.NdJ("selectionChange",function(r){return n.getIdAccount(r.value)}),e.YNc(14,D,2,2,"mat-option",7),e.qZA()(),e.TgZ(15,"mat-form-field",8)(16,"mat-label"),e._uU(17,"Selecciona un hospital"),e.qZA(),e.TgZ(18,"mat-select",9,10),e.NdJ("click",function(){return n.getBuildings()})("selectionChange",function(r){return n.getIdEdificio(r.value)}),e.YNc(20,k,2,2,"mat-option",7),e.qZA()()(),e.TgZ(21,"button",11),e.NdJ("click",function(){return n.onSave()}),e._uU(22," Buscar "),e.qZA()()()(),e.YNc(23,H,4,0,"div",12),e.YNc(24,z,5,0,"div",13),e.YNc(25,P,4,0,"div",12),e.YNc(26,G,5,0,"div",13),e.YNc(27,re,25,3,"div",14)),2&t&&(e.xp6(8),e.Q6J("formGroup",n.warehosForm.baseForm),e.xp6(6),e.Q6J("ngForOf",n.hospitals),e.xp6(6),e.Q6J("ngForOf",n.buildings),e.xp6(1),e.Q6J("disabled",n.warehosForm.baseForm.invalid),e.xp6(2),e.Q6J("ngIf",0===n.dataSource.data.length&&!n.cargadoWarehouse&&n.Buildings.length>0),e.xp6(1),e.Q6J("ngIf",0===n.dataSource.data.length&&!n.cargadoWarehouse&&n.Buildings.length>0),e.xp6(1),e.Q6J("ngIf",0===n.Buildings.length&&!n.cargadoBuilding),e.xp6(1),e.Q6J("ngIf",0===n.Buildings.length&&!n.cargadoBuilding),e.xp6(1),e.Q6J("ngIf",n.dataSource.data.length>0&&n.Buildings.length>0))},directives:[h.xY,l._Y,l.JL,l.sg,W.KE,l.x0,W.hX,Q.gD,l.Q7,l.JJ,l.u,Z.sg,q.ey,Z.O5,_.yS,d.BZ,d.w1,d.fO,d.ge,d.Dz,d.ev,M.lW,d.as,d.XQ,d.nj,d.Gk],styles:[".flex[_ngcontent-%COMP%]{padding:7rem 1rem}div[_ngcontent-%COMP%]{width:80%;margin:0 auto}hr[_ngcontent-%COMP%], table[_ngcontent-%COMP%]{width:100%}th[_ngcontent-%COMP%]{color:#000}.table-button-row[_ngcontent-%COMP%]{margin:0}h1[_ngcontent-%COMP%]{font-weight:700}.del[_ngcontent-%COMP%]{margin:15px}.logged[_ngcontent-%COMP%]{padding-bottom:50px}.edit[_ngcontent-%COMP%]{background-color:#0c0;color:#fff}.mat-form-field[_ngcontent-%COMP%]{margin-right:12px}.modal-form[_ngcontent-%COMP%]{margin:0;height:180px}table-button-row[_ngcontent-%COMP%]{justify-content:center}.bBuscar[_ngcontent-%COMP%]{position:absolute;margin:0}.btn-new[_ngcontent-%COMP%]{width:20%;margin:0 auto}a[_ngcontent-%COMP%]{color:#fff;text-decoration:none}"]}),o})()}];let ue=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[[_.Bz.forChild(le)],_.Bz]}),o})();var de=s(4169);let ce=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[[Z.ez,ue,de.q,l.UX]]}),o})()}}]);